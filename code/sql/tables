-- Création de la table des utilisateurs
CREATE TABLE users (
   user_id SERIAL PRIMARY KEY,
   first_name VARCHAR(100) NOT NULL,
   last_name VARCHAR(100) NOT NULL,
   email VARCHAR(255) UNIQUE NOT NULL,
   password_hash VARCHAR(255) NOT NULL,
   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- Création de la table des bars
CREATE TABLE bars (
   bar_id SERIAL PRIMARY KEY,
   name VARCHAR(255) NOT NULL,
   address VARCHAR(255) NOT NULL,
--    city VARCHAR(100) NOT NULL,
   opening_time TIME NOT NULL,
   closing_time TIME NOT NULL,
   description TEXT,
   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- Création de la table des bières
CREATE TABLE beers (
   beer_id SERIAL PRIMARY KEY,
   name VARCHAR(255) NOT NULL,
   type VARCHAR(100),
   alcohol_content DECIMAL(5, 2),  -- Pourcentage d'alcool
   brewery VARCHAR(255),
   bar_id INT REFERENCES bars(bar_id) ON DELETE CASCADE,
   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- Création de la table des réservations
CREATE TABLE reservations (
   reservation_id SERIAL PRIMARY KEY,
   user_id INT REFERENCES users(user_id) ON DELETE CASCADE,
   bar_id INT REFERENCES bars(bar_id) ON DELETE CASCADE,
   reservation_date DATE NOT NULL,
   reservation_time TIME NOT NULL,
   number_of_people INT NOT NULL,
   status VARCHAR(50) DEFAULT 'Pending',  -- Par exemple : Pending, Confirmed, Canceled
   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- Création de la table des avis
CREATE TABLE reviews (
   review_id SERIAL PRIMARY KEY,
   user_id INT REFERENCES users(user_id) ON DELETE CASCADE,
   bar_id INT REFERENCES bars(bar_id) ON DELETE CASCADE,
   rating INT CHECK (rating >= 1 AND rating <= 5),  -- Note entre 1 et 5
   comment TEXT,
   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- Index pour améliorer les performances des recherches sur les bières par nom
CREATE INDEX idx_beers_name ON beers(name);
-- -- Index pour améliorer les performances des recherches sur les bars par ville
-- CREATE INDEX idx_bars_city ON bars(city);
-- Index pour améliorer les performances des recherches de réservations par date
CREATE INDEX idx_reservations_date ON reservations(reservation_date);